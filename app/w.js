"use strict";var f=require("./8.js"),d=require("events"),y=require("path");function n(l){return l&&typeof l=="object"&&"default"in l?l:{default:l}}function p(l,t){return t.forEach(function(s){s&&typeof s!="string"&&!Array.isArray(s)&&Object.keys(s).forEach(function(e){if(e!=="default"&&!(e in l)){var i=Object.getOwnPropertyDescriptor(s,e);Object.defineProperty(l,e,i.get?i:{enumerable:!0,get:function(){return s[e]}})}})}),Object.freeze(l)}var b=n(d),w=n(y);const K=b.default,k=w.default,_=process.versions.electron?"electron":"node",g=_+"-v"+process.versions.modules+"-"+process.platform+"-"+process.arch,m=k.join(__dirname,"builds",g,"build","Release","iohook.node");let o=f.commonjsRequire(m);const h={3:"keypress",4:"keydown",5:"keyup",6:"mouseclick",7:"mousedown",8:"mouseup",9:"mousemove",10:"mousedrag",11:"mousewheel"};class S extends K{constructor(){super();this.active=!1,this.shortcuts=[],this.eventProperty="keycode",this.activatedShortcuts=[],this.lastKeydownShift=!1,this.lastKeydownAlt=!1,this.lastKeydownCtrl=!1,this.lastKeydownMeta=!1,this.load(),this.setDebug(!1)}start(t){this.active||(this.active=!0,this.setDebug(t))}stop(){this.active&&(this.active=!1)}registerShortcut(t,s,e){let i={},a=Date.now()+Math.random();return t.forEach(r=>{i[r]=!1}),i.id=a,i.callback=s,i.releaseCallback=e,this.shortcuts.push(i),a}unregisterShortcut(t){this.shortcuts.forEach((s,e)=>{s.id===t&&this.shortcuts.splice(e,1)})}unregisterShortcutByKeys(t){for(let s=0;s<this.shortcuts.length;s++){let e=this.shortcuts[s];if(t.forEach((i,a)=>{typeof i!="string"&&!(i instanceof String)&&(t[a]=i.toString())}),Object.keys(e).every(i=>{if(i==="callback"||i==="id")return;let a=t.indexOf(i);return a===-1?!1:(t.splice(a,1),!0)}),t.length===0){this.shortcuts.splice(s,1);return}}}unregisterAllShortcuts(){this.shortcuts.splice(0,this.shortcuts.length)}load(){o.startHook(this._handler.bind(this),this.debug||!1)}unload(){this.stop(),o.stopHook()}setDebug(t){o.debugEnable(t)}useRawcode(t){this.eventProperty=t?"rawcode":"keycode"}disableClickPropagation(){o.grabMouseClick(!0)}enableClickPropagation(){o.grabMouseClick(!1)}_handler(t){if(!(this.active===!1||!t)&&h[t.type]){const s=t.mouse||t.keyboard||t.wheel;s.type=h[t.type],this._handleShift(s),this._handleAlt(s),this._handleCtrl(s),this._handleMeta(s),this.emit(h[t.type],s),(s.type==="keydown"||s.type==="keyup")&&u.shortcuts.length>0&&this._handleShortcut(s)}}_handleShift(t){t.type==="keyup"&&t.shiftKey&&(this.lastKeydownShift=!1),t.type==="keydown"&&t.shiftKey&&(this.lastKeydownShift=!0),this.lastKeydownShift&&(t.shiftKey=!0)}_handleAlt(t){t.type==="keyup"&&t.altKey&&(this.lastKeydownAlt=!1),t.type==="keydown"&&t.altKey&&(this.lastKeydownAlt=!0),this.lastKeydownAlt&&(t.altKey=!0)}_handleCtrl(t){t.type==="keyup"&&t.ctrlKey&&(this.lastKeydownCtrl=!1),t.type==="keydown"&&t.ctrlKey&&(this.lastKeydownCtrl=!0),this.lastKeydownCtrl&&(t.ctrlKey=!0)}_handleMeta(t){t.type==="keyup"&&t.metaKey&&(this.lastKeydownMeta=!1),t.type==="keydown"&&t.metaKey&&(this.lastKeydownMeta=!0),this.lastKeydownMeta&&(t.metaKey=!0)}_handleShortcut(t){if(this.active===!1)return;let s=this.activatedShortcuts;t.type==="keydown"?this.shortcuts.forEach(e=>{if(e[t[this.eventProperty]]!==void 0){e[t[this.eventProperty]]=!0;let i=[],a=!0;Object.keys(e).forEach(r=>{if(!(r==="callback"||r==="releaseCallback"||r==="id")){if(e[r]===!1){a=!1,i.splice(0,i.length);return}i.push(r)}}),a&&(e.callback(i),s.indexOf(e)===-1&&s.push(e))}}):t.type==="keyup"&&(this.shortcuts.forEach(e=>{e[t[this.eventProperty]]!==void 0&&(e[t[this.eventProperty]]=!1)}),this.activatedShortcuts.forEach(e=>{if(e[t[this.eventProperty]]===void 0)return;let i=!0,a=[];if(Object.keys(e).forEach(r=>{r==="callback"||r==="releaseCallback"||r==="id"||(a.push(r),e[r]&&(i=!1))}),i){e.releaseCallback&&e.releaseCallback(a);const r=this.activatedShortcuts.indexOf(e);r!==-1&&this.activatedShortcuts.splice(r,1)}}))}}const u=new S;var c=u,v=Object.freeze(p({__proto__:null,[Symbol.toStringTag]:"Module",default:c},[c]));exports.index=v;
