var G=Object.defineProperty;var q=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var L=(e,a,o)=>a in e?G(e,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[a]=o,j=(e,a)=>{for(var o in a||(a={}))H.call(a,o)&&L(e,o,a[o]);if(q)for(var o of q(a))J.call(a,o)&&L(e,o,a[o]);return e};import{c as r}from"./n.js";import{i as R}from"./2.js";import{w as x,o as v,k as f,F as y,R as C,D as A,u as i,E as b,z as M,A as U,b as P,N as V,S as B,s as F,K as Q,d as X,C as O,m as Y,q as $,v as S,l as Z,y as ee}from"./9.js";import{_ as D}from"./e.js";import{m as K}from"./4.js";import{b as oe}from"./$!.js";import{s as ae}from"./6.js";import{v as re}from"./u.js";import"./v.js";import"./0.js";import"./..js";import"./h.js";import"./$.js";var k,T,I;({camera:k,main:T}=R);I=()=>{var e;if(!document.hidden)switch(k.x(),{src:e}=r,e){case"screen":r.video="";break;default:r.video||(r.video=localStorage.video),e==="all"?k.circle():k.default(800,500),T(!1)}};document.addEventListener("visibilitychange",I);var te={setup:()=>{var e,a,o,t,c,l;for(t=["all \u5C4F\u5E55+\u6444\u50CF\u5934\u5F55\u5236","screen \u5C4F\u5E55\u5F55\u5236","camera \u6444\u50CF\u5934\u5F55\u5236"],l=a=0,o=t.length;a<o;l=++a)e=t[l],c=e.indexOf(" "),t[l]=[e.slice(0,c),e.slice(1+c)];return x(()=>r.src,I),I(),x(()=>r.video,()=>{var u;({src:u}=r),r.video?u==="screen"&&(r.src=localStorage.src||"all"):u!=="screen"&&(localStorage.src=r.src,r.src="screen")}),{li:t,config:r,go:u=>{r.src=u}}}};const ie=e=>(M("data-v-0fd51641"),e=e(),U(),e),se={class:"method"},ne=["onClick"],le=ie(()=>i("b",{class:"ico"},null,-1));function de(e,a){return v(),f("div",se,[(v(!0),f(y,null,C(e.li,([o,t])=>(v(),f("a",{class:A([o,e.config.src==o?"now":""]),onClick:c=>e.go(o)},[le,i("i",null,b(t),1)],10,ne))),256))])}var ce=D(te,[["render",de],["__scopeId","data-v-0fd51641"]]),ue={setup:()=>({config:r,disabled:P(()=>r.src==="camera"),li:"\u6574\u4E2A\u684C\u9762 \u6307\u5B9A\u533A\u57DF".split(" ")})};const ve=e=>(M("data-v-28731d7e"),e=e(),U(),e),fe={class:"bk"},_e=ve(()=>i("h2",null,"\u5F55\u5236\u533A\u57DF",-1)),pe={class:"select"},me=["disabled"],he=["value"];function ge(e,a){return v(),f("div",fe,[_e,i("div",pe,[V(i("select",{disabled:e.disabled,"onUpdate:modelValue":a[0]||(a[0]=o=>e.config.area=o)},[(v(!0),f(y,null,C(e.li,(o,t)=>(v(),f("option",{value:t},b(o),9,he))),256))],8,me),[[B,e.config.area]])])])}var ye=D(ue,[["render",ge],["__scopeId","data-v-28731d7e"]]),be={setup:()=>{var e,a,o,t,c,l,u;return l={audio:F([]),video:F([])},{mediaDevices:t}=navigator,c=async()=>{var n,s,d,_,p,m,g,h,w,E,N;m={},g=await t.enumerateDevices();for(E of g)({kind:_,label:p,deviceId:n}=E),n==="default"&&(p=p.replace("Default - ","\u9ED8\u8BA4 ")),_.endsWith("input")&&(_=_.slice(0,-5),(m[_]=m[_]||[]).push([n,p]));for(d in l)l[d].value=m[d]||[];for(d in l){if({value:w}=l[d],w.length){if(h=r[d],h){for(N of w)if([s]=N,h===s)return}h!==""&&(h=w[0][0])}else h=0;r[d]=h}},o=void 0,a=void 0,e=()=>{a&&(clearInterval(o),a(),a=void 0)},Q(e),u=X(0),O(()=>{var n,s,d;s=["audio","video"];for(n of s)d=r[n],d&&(localStorage[n]=d)}),O(async()=>{var n,s,d,_,p,m,g;e(),{audio:d}=r,!!d&&(g=await K.audio(d),n=new AudioContext,m=n.createMediaStreamSource(g),s=n.createAnalyser(),s.minDecibels=-90,s.maxDecibels=-10,s.fftSize=32,a=()=>(m.disconnect(s),n.close()),_=s.frequencyBinCount,p=new Uint8Array(_),o=setInterval(()=>{s.getByteFrequencyData(p),u.value=Math.round(Math.min(1,Math.max(...p)/200)*100)},100),m.connect(s))}),(async()=>await c())(),j({refresh:c,config:r,x:n=>{var s;s=r[n],s?s="":s=localStorage[n]||"",r[n]=s},vol:u},l)}};const z=e=>(M("data-v-3a61f77c"),e=e(),U(),e),we={class:"bk"},$e=z(()=>i("h2",null,"\u8BBE\u5907\u8BBE\u7F6E",-1)),Se={class:"video"},ke={class:"select"},Ce={label:"\u8F93\u5165\u6E90"},Ie=["value"],De=z(()=>i("optgroup",{label:"\u2500\u2500\u2500"},[i("option",{value:""},"\u7981\u7528")],-1)),Ae={class:"audio"},Ve={class:"select"},Be={label:"\u8F93\u5165\u6E90"},Fe=["value"],Me=z(()=>i("optgroup",{label:"\u2500\u2500\u2500"},[i("option",{value:""},"\u7981\u7528")],-1));function Ue(e,a){return v(),f("div",we,[$e,i("li",Se,[i("label",{class:A({e:e.config.video}),onClick:a[0]||(a[0]=o=>e.x("video")),for:"driveVideo"},null,2),i("div",ke,[V(i("select",{id:"driveVideo",onFocus:a[1]||(a[1]=(...o)=>e.refresh&&e.refresh(...o)),"onUpdate:modelValue":a[2]||(a[2]=o=>e.config.video=o)},[i("optgroup",Ce,[(v(!0),f(y,null,C(e.video,([o,t])=>(v(),f("option",{value:o},b(t),9,Ie))),256))]),De],544),[[B,e.config.video]])])]),i("li",Ae,[i("label",{class:A({e:e.config.audio}),style:Y("--vol:"+e.vol+"%"),onClick:a[3]||(a[3]=o=>e.x("audio")),for:"driveAudio"},null,6),i("div",Ve,[V(i("select",{id:"driveAudio",onFocus:a[4]||(a[4]=(...o)=>e.refresh&&e.refresh(...o)),"onUpdate:modelValue":a[5]||(a[5]=o=>e.config.audio=o)},[i("optgroup",Be,[(v(!0),f(y,null,C(e.audio,([o,t])=>(v(),f("option",{value:o},b(t),9,Fe))),256))]),Me],544),[[B,e.config.audio]])])])])}var ze=D(be,[["render",Ue],["__scopeId","data-v-3a61f77c"]]),W;({auto_update:W}=R);var Ee={components:{src:ce,rArea:ye,drive:ze,btn:oe},setup:()=>{var e,a;return e=F("\u5F55\u5236\u89C6\u9891"),a=o=>{e.value=`\u8BF7\u6388\u6743${o}\u540E\u70B9\u6B64\u5F55\u5236`},{txt:e,start:async()=>{var o,t,c,l,u;l=Object.entries({audio:"\u9EA6\u514B\u98CE",video:"\u6444\u50CF\u5934"});for(u of l)if([t,o]=u,c=r[t],c)try{await K[t](c)}catch{a(o);return}if(r.src!=="camera")try{await re()}catch{a("\u5F55\u5C4F");return}return ae()}}}};(async()=>{for(;;)await W.update_promise(),location.hash!=="#main/config"&&(location.hash="main/update")})();function Ne(e,a){const o=$("src"),t=$("r-area"),c=$("drive"),l=$("btn");return v(),f(y,null,[S(o),i("main",null,[S(t),S(c),S(l,{onClick:e.start},{default:Z(()=>[ee(b(e.txt),1)]),_:1},8,["onClick"])])],64)}var Xe=D(Ee,[["render",Ne],["__scopeId","data-v-52bd6f6a"]]);export{Xe as default};
