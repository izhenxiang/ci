var O=Object.defineProperty;var z=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var q=(e,a,o)=>a in e?O(e,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[a]=o,E=(e,a)=>{for(var o in a||(a={}))G.call(a,o)&&q(e,o,a[o]);if(z)for(var o of z(a))J.call(a,o)&&q(e,o,a[o]);return e};import{c as s}from"./.js";import{w as K,o as u,k as v,F as b,G as $,D as k,u as i,E as y,z as C,A as D,b as R,I as A,J as V,s as B,K as T,d as W,C as N,m as H,q as j,v as S,l as P,y as Q}from"./$.js";import{_ as I}from"./c.js";import{i as X}from"./1.js";import{m as x}from"./2.js";import{b as Y}from"./h.js";import{s as Z}from"./_.js";import{v as ee}from"./q.js";import"./e.js";import"./0.js";import"./-.js";import"./d.js";import"./..js";var oe={setup:()=>{var e,a,o,r,c,d;for(r=["all \u5C4F\u5E55+\u6444\u50CF\u5934\u5F55\u5236","screen \u5C4F\u5E55\u5F55\u5236","camera \u6444\u50CF\u5934\u5F55\u5236"],d=a=0,o=r.length;a<o;d=++a)e=r[d],c=e.indexOf(" "),r[d]=[e.slice(0,c),e.slice(1+c)];return K(()=>s.src,()=>{switch(s.src){case"screen":s.video="";break;default:s.video||(s.video=localStorage.video)}}),{li:r,config:s,go:_=>{s.src=_}}}};const ae=e=>(C("data-v-35d4f793"),e=e(),D(),e),re={class:"method"},te=["onClick"],se=ae(()=>i("b",{class:"ico"},null,-1));function ie(e,a){return u(),v("div",re,[(u(!0),v(b,null,$(e.li,([o,r])=>(u(),v("a",{class:k([o,e.config.src==o?"now":""]),onClick:c=>e.go(o)},[se,i("i",null,y(r),1)],10,te))),256))])}var ne=I(oe,[["render",ie],["__scopeId","data-v-35d4f793"]]),le={setup:()=>({config:s,disabled:R(()=>s.src==="camera"),li:"\u6574\u4E2A\u684C\u9762 \u6307\u5B9A\u533A\u57DF".split(" ")})};const de=e=>(C("data-v-28731d7e"),e=e(),D(),e),ce={class:"bk"},ue=de(()=>i("h2",null,"\u5F55\u5236\u533A\u57DF",-1)),ve={class:"select"},fe=["disabled"],_e=["value"];function pe(e,a){return u(),v("div",ce,[ue,i("div",ve,[A(i("select",{disabled:e.disabled,"onUpdate:modelValue":a[0]||(a[0]=o=>e.config.area=o)},[(u(!0),v(b,null,$(e.li,(o,r)=>(u(),v("option",{value:r},y(o),9,_e))),256))],8,fe),[[V,e.config.area]])])])}var me=I(le,[["render",pe],["__scopeId","data-v-28731d7e"]]),he={setup:()=>{var e,a,o,r,c,d,_;return d={audio:B([]),video:B([])},{mediaDevices:r}=navigator,c=async()=>{var n,l,t,f,p,m,g,h,w,M,U;m={},g=await r.enumerateDevices();for(M of g)({kind:f,label:p,deviceId:n}=M),n==="default"&&(p=p.replace("Default - ","\u9ED8\u8BA4 ")),f.endsWith("input")&&(f=f.slice(0,-5),(m[f]=m[f]||[]).push([n,p]));for(t in d)d[t].value=m[t]||[];for(t in d){if({value:w}=d[t],w.length){if(h=s[t],h){for(U of w)if([l]=U,h===l)return}h!==""&&(h=w[0][0])}else h=0;s[t]=h}},o=void 0,a=void 0,e=()=>{a&&(clearInterval(o),a(),a=void 0)},T(e),_=W(0),N(()=>{var n,l,t;l=["audio","video"];for(n of l)t=s[n],t&&(localStorage[n]=t)}),N(async()=>{var n,l,t,f,p,m,g;e(),{audio:t}=s,!!t&&(g=await x.audio(t),n=new AudioContext,m=n.createMediaStreamSource(g),l=n.createAnalyser(),l.minDecibels=-90,l.maxDecibels=-10,l.fftSize=32,a=()=>(m.disconnect(l),n.close()),f=l.frequencyBinCount,p=new Uint8Array(f),o=setInterval(()=>{l.getByteFrequencyData(p),_.value=Math.round(Math.min(1,Math.max(...p)/200)*100)},100),m.connect(l))}),(async()=>{await c()})(),E({refresh:c,config:s,x:n=>{var l,t;t=s[n],t?t="":t=localStorage[n]||"",n==="video"&&({src:l}=s,t?l==="screen"&&(s.src="all"):l==="all"&&(s.src="screen")),s[n]=t},vol:_},d)}};const F=e=>(C("data-v-518f5ce7"),e=e(),D(),e),ge={class:"bk"},be=F(()=>i("h2",null,"\u8BBE\u5907\u8BBE\u7F6E",-1)),ye={class:"video"},we={class:"select"},$e={label:"\u8F93\u5165\u6E90"},je=["value"],Se=F(()=>i("optgroup",{label:"\u2500\u2500\u2500"},[i("option",{value:""},"\u7981\u7528")],-1)),Ie={class:"audio"},ke={class:"select"},Ce={label:"\u8F93\u5165\u6E90"},De=["value"],Ae=F(()=>i("optgroup",{label:"\u2500\u2500\u2500"},[i("option",{value:""},"\u7981\u7528")],-1));function Ve(e,a){return u(),v("div",ge,[be,i("li",ye,[i("label",{class:k({e:e.config.video}),onClick:a[0]||(a[0]=o=>e.x("video")),for:"driveVideo"},null,2),i("div",we,[A(i("select",{id:"driveVideo",onFocus:a[1]||(a[1]=(...o)=>e.refresh&&e.refresh(...o)),"onUpdate:modelValue":a[2]||(a[2]=o=>e.config.video=o)},[i("optgroup",$e,[(u(!0),v(b,null,$(e.video,([o,r])=>(u(),v("option",{value:o},y(r),9,je))),256))]),Se],544),[[V,e.config.video]])])]),i("li",Ie,[i("label",{class:k({e:e.config.audio}),style:H("--vol:"+e.vol+"%"),onClick:a[3]||(a[3]=o=>e.x("audio")),for:"driveAudio"},null,6),i("div",ke,[A(i("select",{id:"driveAudio",onFocus:a[4]||(a[4]=(...o)=>e.refresh&&e.refresh(...o)),"onUpdate:modelValue":a[5]||(a[5]=o=>e.config.audio=o)},[i("optgroup",Ce,[(u(!0),v(b,null,$(e.audio,([o,r])=>(u(),v("option",{value:o},y(r),9,De))),256))]),Ae],544),[[V,e.config.audio]])])])])}var Be=I(he,[["render",Ve],["__scopeId","data-v-518f5ce7"]]),L;({auto_update:L}=X);var Fe={components:{src:ne,rArea:me,drive:Be,btn:Y},setup:()=>{var e,a;return e=B("\u5F55\u5236\u89C6\u9891"),a=o=>{e.value=`\u8BF7\u6388\u6743${o}\u540E\u70B9\u6B64\u5F55\u5236`},{txt:e,start:async()=>{var o,r,c,d,_;d=Object.entries({audio:"\u9EA6\u514B\u98CE",video:"\u6444\u50CF\u5934"});for(_ of d)if([r,o]=_,c=s[r],c)try{await x[r](c)}catch{a(o);return}if(s.src!=="camera")try{await ee()}catch{a("\u5F55\u5C4F");return}return Z()}}}};(async()=>{for(;;)await L.update_promise(),location.hash!=="#main/config"&&(location.hash="main/update")})();function Me(e,a){const o=j("src"),r=j("r-area"),c=j("drive"),d=j("btn");return u(),v(b,null,[S(o),i("main",null,[S(r),S(c),S(d,{onClick:e.start},{default:P(()=>[Q(y(e.txt),1)]),_:1},8,["onClick"])])],64)}var He=I(Fe,[["render",Me],["__scopeId","data-v-0dc19923"]]);export{He as default};
