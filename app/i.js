var H=Object.defineProperty;var x=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var L=(e,a,o)=>a in e?H(e,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[a]=o,j=(e,a)=>{for(var o in a||(a={}))J.call(a,o)&&L(e,o,a[o]);if(x)for(var o of x(a))P.call(a,o)&&L(e,o,a[o]);return e};import{c as r}from"./l.js";import{i as T}from"./0.js";import{w as O,o as v,k as f,F as b,R as I,D as V,u as i,E as w,z as U,A as z,b as Q,N as B,S as F,s as M,K as X,d as Y,C as R,m as Z,q as $,v as k,l as ee,y as oe}from"./7.js";import{_ as A}from"./_.js";import{m as K}from"./1.js";import{b as ae}from"./o.js";import{s as re}from"./4.js";import{v as te}from"./v.js";import"./w.js";import"./..js";import"./$.js";import"./b.js";import"./3.js";var y,W,C,D;({camera:y,main:W}=T);C=void 0;D=()=>{var e;if(document.hidden){C=void 0,localStorage.recing||y.x();return}if(delete localStorage.recing,{src:e}=r,e!==C)switch(C=e,y.x(),e){case"screen":r.video="";break;default:r.video||(r.video=localStorage.video),e==="all"?y.circle():y.default(800,500),setTimeout(()=>{document.hidden||W(!1)},1e3)}};document.addEventListener("visibilitychange",D);var ie={setup:()=>{var e,a,o,t,c,l;for(t=["all \u5C4F\u5E55+\u6444\u50CF\u5934\u5F55\u5236","screen \u5C4F\u5E55\u5F55\u5236","camera \u6444\u50CF\u5934\u5F55\u5236"],l=a=0,o=t.length;a<o;l=++a)e=t[l],c=e.indexOf(" "),t[l]=[e.slice(0,c),e.slice(1+c)];return O(()=>r.src,D),D(),O(()=>r.video,()=>{var u;({src:u}=r),r.video?u==="screen"&&(r.src=localStorage.src||"all"):u!=="screen"&&(localStorage.src=r.src,r.src="screen")}),{li:t,config:r,go:u=>{r.src=u}}}};const se=e=>(U("data-v-634215d1"),e=e(),z(),e),ne={class:"method"},le=["onClick"],de=se(()=>i("b",{class:"ico"},null,-1));function ce(e,a){return v(),f("div",ne,[(v(!0),f(b,null,I(e.li,([o,t])=>(v(),f("a",{class:V([o,e.config.src==o?"now":""]),onClick:c=>e.go(o)},[de,i("i",null,w(t),1)],10,le))),256))])}var ue=A(ie,[["render",ce],["__scopeId","data-v-634215d1"]]),ve={setup:()=>({config:r,disabled:Q(()=>r.src==="camera"),li:"\u6574\u4E2A\u684C\u9762 \u6307\u5B9A\u533A\u57DF".split(" ")})};const fe=e=>(U("data-v-28731d7e"),e=e(),z(),e),_e={class:"bk"},pe=fe(()=>i("h2",null,"\u5F55\u5236\u533A\u57DF",-1)),me={class:"select"},he=["disabled"],ge=["value"];function ye(e,a){return v(),f("div",_e,[pe,i("div",me,[B(i("select",{disabled:e.disabled,"onUpdate:modelValue":a[0]||(a[0]=o=>e.config.area=o)},[(v(!0),f(b,null,I(e.li,(o,t)=>(v(),f("option",{value:t},w(o),9,ge))),256))],8,he),[[F,e.config.area]])])])}var be=A(ve,[["render",ye],["__scopeId","data-v-28731d7e"]]),we={setup:()=>{var e,a,o,t,c,l,u;return l={audio:M([]),video:M([])},{mediaDevices:t}=navigator,c=async()=>{var n,s,d,_,p,m,g,h,S,N,q;m={},g=await t.enumerateDevices();for(N of g)({kind:_,label:p,deviceId:n}=N),n==="default"&&(p=p.replace("Default - ","\u9ED8\u8BA4 ")),_.endsWith("input")&&(_=_.slice(0,-5),(m[_]=m[_]||[]).push([n,p]));for(d in l)l[d].value=m[d]||[];for(d in l){if({value:S}=l[d],S.length){if(h=r[d],h){for(q of S)if([s]=q,h===s)return}h!==""&&(h=S[0][0])}else h=0;r[d]=h}},o=void 0,a=void 0,e=()=>{a&&(clearInterval(o),a(),a=void 0)},X(e),u=Y(0),R(()=>{var n,s,d;s=["audio","video"];for(n of s)d=r[n],d&&(localStorage[n]=d)}),R(async()=>{var n,s,d,_,p,m,g;e(),{audio:d}=r,!!d&&(g=await K.audio(d),n=new AudioContext,m=n.createMediaStreamSource(g),s=n.createAnalyser(),s.minDecibels=-90,s.maxDecibels=-10,s.fftSize=32,a=()=>(m.disconnect(s),n.close()),_=s.frequencyBinCount,p=new Uint8Array(_),o=setInterval(()=>{s.getByteFrequencyData(p),u.value=Math.round(Math.min(1,Math.max(...p)/200)*100)},100),m.connect(s))}),(async()=>await c())(),j({refresh:c,config:r,x:n=>{var s;s=r[n],s?s="":s=localStorage[n]||"",r[n]=s},vol:u},l)}};const E=e=>(U("data-v-3a61f77c"),e=e(),z(),e),Se={class:"bk"},$e=E(()=>i("h2",null,"\u8BBE\u5907\u8BBE\u7F6E",-1)),ke={class:"video"},Ce={class:"select"},Ie={label:"\u8F93\u5165\u6E90"},De=["value"],Ae=E(()=>i("optgroup",{label:"\u2500\u2500\u2500"},[i("option",{value:""},"\u7981\u7528")],-1)),Ve={class:"audio"},Be={class:"select"},Fe={label:"\u8F93\u5165\u6E90"},Me=["value"],Ue=E(()=>i("optgroup",{label:"\u2500\u2500\u2500"},[i("option",{value:""},"\u7981\u7528")],-1));function ze(e,a){return v(),f("div",Se,[$e,i("li",ke,[i("label",{class:V({e:e.config.video}),onClick:a[0]||(a[0]=o=>e.x("video")),for:"driveVideo"},null,2),i("div",Ce,[B(i("select",{id:"driveVideo",onFocus:a[1]||(a[1]=(...o)=>e.refresh&&e.refresh(...o)),"onUpdate:modelValue":a[2]||(a[2]=o=>e.config.video=o)},[i("optgroup",Ie,[(v(!0),f(b,null,I(e.video,([o,t])=>(v(),f("option",{value:o},w(t),9,De))),256))]),Ae],544),[[F,e.config.video]])])]),i("li",Ve,[i("label",{class:V({e:e.config.audio}),style:Z("--vol:"+e.vol+"%"),onClick:a[3]||(a[3]=o=>e.x("audio")),for:"driveAudio"},null,6),i("div",Be,[B(i("select",{id:"driveAudio",onFocus:a[4]||(a[4]=(...o)=>e.refresh&&e.refresh(...o)),"onUpdate:modelValue":a[5]||(a[5]=o=>e.config.audio=o)},[i("optgroup",Fe,[(v(!0),f(b,null,I(e.audio,([o,t])=>(v(),f("option",{value:o},w(t),9,Me))),256))]),Ue],544),[[F,e.config.audio]])])])])}var Ee=A(we,[["render",ze],["__scopeId","data-v-3a61f77c"]]),G;({auto_update:G}=T);var Ne={components:{src:ue,rArea:be,drive:Ee,btn:ae},setup:()=>{var e,a;return e=M("\u5F55\u5236\u89C6\u9891"),a=o=>{e.value=`\u8BF7\u6388\u6743${o}\u540E\u70B9\u6B64\u5F55\u5236`},{txt:e,start:async()=>{var o,t,c,l,u;l=Object.entries({audio:"\u9EA6\u514B\u98CE",video:"\u6444\u50CF\u5934"});for(u of l)if([t,o]=u,c=r[t],c)try{await K[t](c)}catch{a(o);return}if(r.src!=="camera")try{await te()}catch{a("\u5F55\u5C4F");return}localStorage.recing=1,re()}}}};(async()=>{for(;;)await G.update_promise(),location.hash!=="#main/about"&&(location.hash="main/update")})();function qe(e,a){const o=$("src"),t=$("r-area"),c=$("drive"),l=$("btn");return v(),f(b,null,[k(o),i("main",null,[k(t),k(c),k(l,{onClick:e.start},{default:ee(()=>[oe(w(e.txt),1)]),_:1},8,["onClick"])])],64)}var Ye=A(Ne,[["render",qe],["__scopeId","data-v-63723ada"]]);export{Ye as default};
