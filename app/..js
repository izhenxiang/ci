var T=Object.defineProperty;var q=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var x=(e,a,o)=>a in e?T(e,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[a]=o,L=(e,a)=>{for(var o in a||(a={}))W.call(a,o)&&x(e,o,a[o]);if(q)for(var o of q(a))H.call(a,o)&&x(e,o,a[o]);return e};import{c as r}from"./.js";import{i as N}from"./2.js";import{w as O,o as u,k as v,F as g,G as $,D,u as i,E as y,z as A,A as V,b as P,I as B,J as F,s as M,K as Q,d as X,C as G,m as Y,q as j,v as S,l as Z,y as ee}from"./-.js";import{_ as I}from"./e.js";import{m as J}from"./3.js";import{b as oe}from"./j.js";import{s as ae}from"./c.js";import{v as re}from"./t.js";import"./h.js";import"./1.js";import"./0.js";import"./f.js";import"./4.js";var k,K,C;({camera:k,main:K}=N);C=()=>{var e;switch(k.x(),{src:e}=r,e){case"screen":r.video="";break;default:r.video||(r.video=localStorage.video),e==="all"?k.circle():k.default(800,500),K(!1)}};document.addEventListener("visibilitychange",()=>{document.hidden||C()});var se={setup:()=>{var e,a,o,s,c,d;for(s=["all \u5C4F\u5E55+\u6444\u50CF\u5934\u5F55\u5236","screen \u5C4F\u5E55\u5F55\u5236","camera \u6444\u50CF\u5934\u5F55\u5236"],d=a=0,o=s.length;a<o;d=++a)e=s[d],c=e.indexOf(" "),s[d]=[e.slice(0,c),e.slice(1+c)];return O(()=>r.src,C),C(),O(()=>r.video,()=>{r.video?r.src==="screen"&&(r.src="all"):r.src!=="screen"&&(r.src="screen")}),{li:s,config:r,go:_=>{r.src=_}}}};const te=e=>(A("data-v-20c2005e"),e=e(),V(),e),ie={class:"method"},ne=["onClick"],le=te(()=>i("b",{class:"ico"},null,-1));function de(e,a){return u(),v("div",ie,[(u(!0),v(g,null,$(e.li,([o,s])=>(u(),v("a",{class:D([o,e.config.src==o?"now":""]),onClick:c=>e.go(o)},[le,i("i",null,y(s),1)],10,ne))),256))])}var ce=I(se,[["render",de],["__scopeId","data-v-20c2005e"]]),ue={setup:()=>({config:r,disabled:P(()=>r.src==="camera"),li:"\u6574\u4E2A\u684C\u9762 \u6307\u5B9A\u533A\u57DF".split(" ")})};const ve=e=>(A("data-v-28731d7e"),e=e(),V(),e),fe={class:"bk"},_e=ve(()=>i("h2",null,"\u5F55\u5236\u533A\u57DF",-1)),pe={class:"select"},me=["disabled"],he=["value"];function be(e,a){return u(),v("div",fe,[_e,i("div",pe,[B(i("select",{disabled:e.disabled,"onUpdate:modelValue":a[0]||(a[0]=o=>e.config.area=o)},[(u(!0),v(g,null,$(e.li,(o,s)=>(u(),v("option",{value:s},y(o),9,he))),256))],8,me),[[F,e.config.area]])])])}var ge=I(ue,[["render",be],["__scopeId","data-v-28731d7e"]]),ye={setup:()=>{var e,a,o,s,c,d,_;return d={audio:M([]),video:M([])},{mediaDevices:s}=navigator,c=async()=>{var n,l,t,f,p,m,b,h,w,z,E;m={},b=await s.enumerateDevices();for(z of b)({kind:f,label:p,deviceId:n}=z),n==="default"&&(p=p.replace("Default - ","\u9ED8\u8BA4 ")),f.endsWith("input")&&(f=f.slice(0,-5),(m[f]=m[f]||[]).push([n,p]));for(t in d)d[t].value=m[t]||[];for(t in d){if({value:w}=d[t],w.length){if(h=r[t],h){for(E of w)if([l]=E,h===l)return}h!==""&&(h=w[0][0])}else h=0;r[t]=h}},o=void 0,a=void 0,e=()=>{a&&(clearInterval(o),a(),a=void 0)},Q(e),_=X(0),G(()=>{var n,l,t;l=["audio","video"];for(n of l)t=r[n],t&&(localStorage[n]=t)}),G(async()=>{var n,l,t,f,p,m,b;e(),{audio:t}=r,!!t&&(b=await J.audio(t),n=new AudioContext,m=n.createMediaStreamSource(b),l=n.createAnalyser(),l.minDecibels=-90,l.maxDecibels=-10,l.fftSize=32,a=()=>(m.disconnect(l),n.close()),f=l.frequencyBinCount,p=new Uint8Array(f),o=setInterval(()=>{l.getByteFrequencyData(p),_.value=Math.round(Math.min(1,Math.max(...p)/200)*100)},100),m.connect(l))}),(async()=>{await c()})(),L({refresh:c,config:r,x:n=>{var l,t;t=r[n],t?t="":t=localStorage[n]||"",n==="video"&&({src:l}=r,t?l==="screen"&&(r.src="all"):l==="all"&&(r.src="screen")),r[n]=t},vol:_},d)}};const U=e=>(A("data-v-518f5ce7"),e=e(),V(),e),we={class:"bk"},$e=U(()=>i("h2",null,"\u8BBE\u5907\u8BBE\u7F6E",-1)),je={class:"video"},Se={class:"select"},Ie={label:"\u8F93\u5165\u6E90"},ke=["value"],Ce=U(()=>i("optgroup",{label:"\u2500\u2500\u2500"},[i("option",{value:""},"\u7981\u7528")],-1)),De={class:"audio"},Ae={class:"select"},Ve={label:"\u8F93\u5165\u6E90"},Be=["value"],Fe=U(()=>i("optgroup",{label:"\u2500\u2500\u2500"},[i("option",{value:""},"\u7981\u7528")],-1));function Me(e,a){return u(),v("div",we,[$e,i("li",je,[i("label",{class:D({e:e.config.video}),onClick:a[0]||(a[0]=o=>e.x("video")),for:"driveVideo"},null,2),i("div",Se,[B(i("select",{id:"driveVideo",onFocus:a[1]||(a[1]=(...o)=>e.refresh&&e.refresh(...o)),"onUpdate:modelValue":a[2]||(a[2]=o=>e.config.video=o)},[i("optgroup",Ie,[(u(!0),v(g,null,$(e.video,([o,s])=>(u(),v("option",{value:o},y(s),9,ke))),256))]),Ce],544),[[F,e.config.video]])])]),i("li",De,[i("label",{class:D({e:e.config.audio}),style:Y("--vol:"+e.vol+"%"),onClick:a[3]||(a[3]=o=>e.x("audio")),for:"driveAudio"},null,6),i("div",Ae,[B(i("select",{id:"driveAudio",onFocus:a[4]||(a[4]=(...o)=>e.refresh&&e.refresh(...o)),"onUpdate:modelValue":a[5]||(a[5]=o=>e.config.audio=o)},[i("optgroup",Ve,[(u(!0),v(g,null,$(e.audio,([o,s])=>(u(),v("option",{value:o},y(s),9,Be))),256))]),Fe],544),[[F,e.config.audio]])])])])}var Ue=I(ye,[["render",Me],["__scopeId","data-v-518f5ce7"]]),R;({auto_update:R}=N);var ze={components:{src:ce,rArea:ge,drive:Ue,btn:oe},setup:()=>{var e,a;return e=M("\u5F55\u5236\u89C6\u9891"),a=o=>{e.value=`\u8BF7\u6388\u6743${o}\u540E\u70B9\u6B64\u5F55\u5236`},{txt:e,start:async()=>{var o,s,c,d,_;d=Object.entries({audio:"\u9EA6\u514B\u98CE",video:"\u6444\u50CF\u5934"});for(_ of d)if([s,o]=_,c=r[s],c)try{await J[s](c)}catch{a(o);return}if(r.src!=="camera")try{await re()}catch{a("\u5F55\u5C4F");return}return ae()}}}};(async()=>{for(;;)await R.update_promise(),location.hash!=="#main/config"&&(location.hash="main/update")})();function Ee(e,a){const o=j("src"),s=j("r-area"),c=j("drive"),d=j("btn");return u(),v(g,null,[S(o),i("main",null,[S(s),S(c),S(d,{onClick:e.start},{default:Z(()=>[ee(y(e.txt),1)]),_:1},8,["onClick"])])],64)}var Xe=I(ze,[["render",Ee],["__scopeId","data-v-41c5b547"]]);export{Xe as default};
