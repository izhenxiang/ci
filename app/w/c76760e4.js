import{i as Se}from"./f055c35d.js";import"./c73e65f4.js";import{g as se,a as We,c as oe}from"./ea62816e.js";import{b as R,w as W,d as te,e as ie,f as ue,g as de,i as V,t as ne,h as k,j as fe,p as B,s as q,n as xe,c as Oe,k as he,l as Ee,m as ge,o as Ne,q as $e,u as je,v as Ce}from"./9426e368.js";import{s as Ae}from"./51ca2cde.js";import{_ as Te}from"./index.js";import"./08f73616.js";import"./45a6611b.js";var ce={},Ve=Object.defineProperty,Be=Object.defineProperties,Ie=Object.getOwnPropertyDescriptors,ve=Object.getOwnPropertySymbols,Ye=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable,pe=(e,t,a)=>t in e?Ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,me=(e,t)=>{for(var a in t||(t={}))Ye.call(t,a)&&pe(e,a,t[a]);if(ve)for(var a of ve(t))Xe.call(t,a)&&pe(e,a,t[a]);return e},be=(e,t)=>Be(e,Ie(t));const ye=Symbol("Vue3DraggableResizable");function we(e){const t=window.getComputedStyle(e);return{width:parseFloat(t.getPropertyValue("width")),height:parseFloat(t.getPropertyValue("height"))}}function ze(e){return(t,a,n)=>{!t||(typeof a=="string"&&(a=[a]),a.forEach(i=>t[e](i,n,{passive:!1})))}}const G=ze("addEventListener"),N=ze("removeEventListener");function _e(e){if(e&&e.length>0){const t=[];return e.forEach(a=>{re.includes(a)&&!t.includes(a)&&t.push(a)}),t}else return[]}function Ue(){return String(Math.random()).substr(2)+String(Date.now())}function Fe(e,t,a){if(e.disabled.value)return null;const n={row:[],col:[]},{parentWidth:i,parentHeight:s}=t;n.row.push(...e.adsorbRows),n.col.push(...e.adsorbCols),e.adsorbParent.value&&(n.row.push(0,s.value,s.value/2),n.col.push(0,i.value,i.value/2));const o=e.getPositionStore(a);return Object.values(o).forEach(({x:l,y:r,w:d,h})=>{n.row.push(r,r+h,r+h/2),n.col.push(l,l+d,l+d/2)}),{row:n.row.reduce((l,r)=>be(me({},l),{[r]:{min:r-5,max:r+5,value:r}}),{}),col:n.col.reduce((l,r)=>be(me({},l),{[r]:{min:r-5,max:r+5,value:r}}),{})}}var qe=Object.defineProperty,He=Object.getOwnPropertySymbols,Ge=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable,Me=(e,t,a)=>t in e?qe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,Le=(e,t)=>{for(var a in t||(t={}))Ge.call(t,a)&&Me(e,a,t[a]);if(He)for(var a of He(t))Je.call(t,a)&&Me(e,a,t[a]);return e};function D(e){const t=te(e);return[t,n=>(t.value=n,n)]}function Ke(e,t){const[a,n]=D(e.initW),[i,s]=D(e.initH),[o,u]=D(e.x),[l,r]=D(e.y),[d,h]=D(e.active),[b,v]=D(!1),[M,_]=D(!1),[x,y]=D(""),[$,m]=D(1/0),[U,F]=D(1/0),[O,P]=D(e.minW),[L,I]=D(e.minH),j=R(()=>i.value/a.value);return W(a,f=>{t("update:w",f)},{immediate:!0}),W(i,f=>{t("update:h",f)},{immediate:!0}),W(l,f=>{t("update:y",f)}),W(o,f=>{t("update:x",f)}),W(d,(f,Y)=>{t("update:active",f),!Y&&f?t("activated"):Y&&!f&&t("deactivated")}),W(()=>e.active,f=>{h(f)}),{id:Ue(),width:a,height:i,top:l,left:o,enable:d,dragging:b,resizing:M,resizingHandle:x,resizingMaxHeight:U,resizingMaxWidth:$,resizingMinWidth:O,resizingMinHeight:L,aspectRatio:j,setEnable:h,setDragging:v,setResizing:_,setResizingHandle:y,setResizingMaxHeight:F,setResizingMaxWidth:m,setResizingMinWidth:P,setResizingMinHeight:I,setWidth:f=>n(Math.floor(f)),setHeight:f=>s(Math.floor(f)),setTop:f=>r(Math.floor(f)),setLeft:f=>u(Math.floor(f))}}function Qe(e){const t=te(0),a=te(0);return ie(()=>{if(e.value&&e.value.parentElement){const{width:n,height:i}=we(e.value.parentElement);t.value=n,a.value=i}}),{parentWidth:t,parentHeight:a}}function Ze(e,t,a){const{width:n,height:i,left:s,top:o,resizingMaxWidth:u,resizingMaxHeight:l,resizingMinWidth:r,resizingMinHeight:d}=a,{setWidth:h,setHeight:b,setTop:v,setLeft:M}=a,{parentWidth:_,parentHeight:x}=t,y={minWidth:R(()=>r.value),minHeight:R(()=>d.value),maxWidth:R(()=>{let m=1/0;return e.parent&&(m=Math.min(_.value,u.value)),m}),maxHeight:R(()=>{let m=1/0;return e.parent&&(m=Math.min(x.value,l.value)),m}),minLeft:R(()=>e.parent?0:-1/0),minTop:R(()=>e.parent?0:-1/0),maxLeft:R(()=>e.parent?_.value-n.value:1/0),maxTop:R(()=>e.parent?x.value-i.value:1/0)},$={setWidth(m){return e.disabledW?n.value:h(Math.min(y.maxWidth.value,Math.max(y.minWidth.value,m)))},setHeight(m){return e.disabledH?i.value:b(Math.min(y.maxHeight.value,Math.max(y.minHeight.value,m)))},setTop(m){return e.disabledY?o.value:v(Math.min(y.maxTop.value,Math.max(y.minTop.value,m)))},setLeft(m){return e.disabledX?s.value:M(Math.min(y.maxLeft.value,Math.max(y.minLeft.value,m)))}};return Le(Le({},y),$)}const le=["mousedown","touchstart"],J=["mouseup","touchend"],K=["mousemove","touchmove"];function ee(e){return"touches"in e?[e.touches[0].pageX,e.touches[0].pageY]:[e.pageX,e.pageY]}function ke(e,t,a,n,i,s,o){const{left:u,top:l,width:r,height:d,dragging:h,id:b}=t,{setDragging:v,setEnable:M,setResizing:_,setResizingHandle:x}=t,{setTop:y,setLeft:$}=a;let m=0,U=0,F=0,O=0,P=null;const L=document.documentElement,I=p=>{var S;const H=p.target;((S=e.value)==null?void 0:S.contains(H))||(M(!1),v(!1),_(!1),x(""))},j=()=>{v(!1),N(L,J,j),N(L,K,f),P=null,s&&(s.updatePosition(b,{x:u.value,y:l.value,w:r.value,h:d.value}),s.setMatchedLine(null))},f=p=>{if(p.preventDefault(),!(h.value&&e.value))return;const[H,S]=ee(p),Q=H-F,Z=S-O;let E=m+Q,C=U+Z;if(P!==null){const A={col:[E,E+r.value/2,E+r.value],row:[C,C+d.value/2,C+d.value]},T={row:A.row.map((w,c)=>{let g=null;return Object.values(P.row).forEach(z=>{w>=z.min&&w<=z.max&&(g=z.value)}),g!==null&&(c===0?C=g:c===1?C=Math.floor(g-d.value/2):c===2&&(C=Math.floor(g-d.value))),g}).filter(w=>w!==null),col:A.col.map((w,c)=>{let g=null;return Object.values(P.col).forEach(z=>{w>=z.min&&w<=z.max&&(g=z.value)}),g!==null&&(c===0?E=g:c===1?E=Math.floor(g-r.value/2):c===2&&(E=Math.floor(g-r.value))),g}).filter(w=>w!==null)};s.setMatchedLine(T)}i("dragging",{x:$(E),y:y(C)})},Y=p=>{!n.value||(v(!0),m=u.value,U=l.value,F=ee(p)[0],O=ee(p)[1],G(L,K,f),G(L,J,j),s&&!s.disabled.value&&(P=Fe(s,o,b)))};return W(h,(p,H)=>{!H&&p?(i("drag-start",{x:u.value,y:l.value}),M(!0),v(!0)):(i("drag-end",{x:u.value,y:l.value}),v(!1))}),ie(()=>{const p=e.value;!p||(p.style.left=u+"px",p.style.top=l+"px",G(L,le,I),G(p,le,Y))}),ue(()=>{!e.value||(N(L,le,I),N(L,J,j),N(L,K,f))}),{containerRef:e}}function et(e,t,a,n,i){const{setWidth:s,setHeight:o,setLeft:u,setTop:l}=t,{width:r,height:d,left:h,top:b,aspectRatio:v}=e,{setResizing:M,setResizingHandle:_,setResizingMaxWidth:x,setResizingMaxHeight:y,setResizingMinWidth:$,setResizingMinHeight:m}=e,{parentWidth:U,parentHeight:F}=a;let O=0,P=0,L=0,I=0,j=0,f=0,Y=1,p="",H="";const S=document.documentElement,Q=A=>{A.preventDefault();let[T,w]=ee(A),c=T-j,g=w-f,z=c,X=g;n.lockAspectRatio&&(c=Math.abs(c),g=c*Y,(z<0||H==="m"&&X<0)&&(c=-c,g=-g)),p==="t"?(o(P-g),l(I-(d.value-P))):p==="b"&&o(P+g),H==="l"?(s(O-c),u(L-(r.value-O))):H==="r"&&s(O+c),i("resizing",{x:h.value,y:b.value,w:r.value,h:d.value})},Z=()=>{i("resize-end",{x:h.value,y:b.value,w:r.value,h:d.value}),_(""),M(!1),x(1/0),y(1/0),$(n.minW),m(n.minH),N(S,K,Q),N(S,J,Z)},E=(A,T)=>{if(!n.resizable)return;A.stopPropagation(),_(T),M(!0),p=T[0],H=T[1],v.value&&(["tl","tm","ml","bl"].includes(T)?(p="t",H="l"):(p="b",H="r"));let w=n.minH,c=n.minW;if(w/c>v.value?c=w/v.value:w=c*v.value,$(c),m(w),parent){let z=p==="t"?b.value+d.value:F.value-b.value,X=H==="l"?h.value+r.value:U.value-h.value;n.lockAspectRatio&&(z/X<v.value?X=z/v.value:z=X*v.value),y(z),x(X)}O=r.value,P=d.value,L=h.value,I=b.value;const g=ee(A);j=g[0],f=g[1],Y=v.value,i("resize-start",{x:h.value,y:b.value,w:r.value,h:d.value}),G(S,K,Q),G(S,J,Z)};return ue(()=>{N(S,J,Z),N(S,K,Q)}),{handlesFiltered:R(()=>n.resizable?_e(n.handles):[]),resizeHandleDown:E}}function tt(e,t){const{setWidth:a,setHeight:n,setLeft:i,setTop:s}=t;W(()=>e.w,o=>{a(o)}),W(()=>e.h,o=>{n(o)}),W(()=>e.x,o=>{i(o)}),W(()=>e.y,o=>{s(o)})}var at=Object.defineProperty,Pe=Object.getOwnPropertySymbols,it=Object.prototype.hasOwnProperty,nt=Object.prototype.propertyIsEnumerable,Re=(e,t,a)=>t in e?at(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,ae=(e,t)=>{for(var a in t||(t={}))it.call(t,a)&&Re(e,a,t[a]);if(Pe)for(var a of Pe(t))nt.call(t,a)&&Re(e,a,t[a]);return e};const re=["tl","tm","tr","ml","mr","bl","bm","br"],lt={initW:{type:Number,default:null},initH:{type:Number,default:null},w:{type:Number,default:0},h:{type:Number,default:0},x:{type:Number,default:0},y:{type:Number,default:0},draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},disabledX:{type:Boolean,default:!1},disabledY:{type:Boolean,default:!1},disabledW:{type:Boolean,default:!1},disabledH:{type:Boolean,default:!1},minW:{type:Number,default:20},minH:{type:Number,default:20},active:{type:Boolean,default:!1},parent:{type:Boolean,default:!1},handles:{type:Array,default:re,validator:e=>_e(e).length===e.length},classNameDraggable:{type:String,default:"draggable"},classNameResizable:{type:String,default:"resizable"},classNameDragging:{type:String,default:"dragging"},classNameResizing:{type:String,default:"resizing"},classNameActive:{type:String,default:"active"},classNameHandle:{type:String,default:"handle"},lockAspectRatio:{type:Boolean,default:!1}},rt=["activated","deactivated","drag-start","resize-start","dragging","resizing","drag-end","resize-end","update:w","update:h","update:x","update:y","update:active"],st=de({name:"Vue3DraggableResizable",props:lt,emits:rt,setup(e,{emit:t}){const a=Ke(e,t),n=V("identity");let i=null;n===ye&&(i={updatePosition:V("updatePosition"),getPositionStore:V("getPositionStore"),disabled:V("disabled"),adsorbParent:V("adsorbParent"),adsorbCols:V("adsorbCols"),adsorbRows:V("adsorbRows"),setMatchedLine:V("setMatchedLine")});const s=te(),o=Qe(s),u=Ze(e,o,a);ke(s,a,u,ne(e,"draggable"),t,i,o);const l=et(a,u,o,e,t);return tt(e,u),ae(ae(ae(ae({containerRef:s,containerProvider:i},a),o),u),l)},computed:{style(){return{width:this.width+"px",height:this.height+"px",top:this.top+"px",left:this.left+"px"}},klass(){return{[this.classNameActive]:this.enable,[this.classNameDragging]:this.dragging,[this.classNameResizing]:this.resizing,[this.classNameDraggable]:this.draggable,[this.classNameResizable]:this.resizable}}},mounted(){if(!this.containerRef)return;this.containerRef.ondragstart=()=>!1;const{width:e,height:t}=we(this.containerRef);this.setWidth(this.initW===null?this.w||e:this.initW),this.setHeight(this.initH===null?this.h||t:this.initH),this.containerProvider&&this.containerProvider.updatePosition(this.id,{x:this.left,y:this.top,w:this.width,h:this.height})},render(){return k("div",{ref:"containerRef",class:["vdr-container",this.klass],style:this.style},[this.$slots.default&&this.$slots.default(),...this.handlesFiltered.map(e=>k("div",{class:["vdr-handle","vdr-handle-"+e,this.classNameHandle,`${this.classNameHandle}-${e}`],style:{display:this.enable?"block":"none"},onMousedown:t=>this.resizeHandleDown(t,e),onTouchstart:t=>this.resizeHandleDown(t,e)}))])}});var ot=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",ALL_HANDLES:re,default:st}),ut=se(ot),dt=de({name:"DraggableContainer",props:{disabled:{type:Boolean,default:!1},adsorbParent:{type:Boolean,default:!0},adsorbCols:{type:Array,default:null},adsorbRows:{type:Array,default:null},referenceLineVisible:{type:Boolean,default:!0},referenceLineColor:{type:String,default:"#f00"}},setup(e){const t=fe({}),a=(l,r)=>{t[l]=r},n=l=>{const r=Object.assign({},t);return l&&delete r[l],r},i=fe({matchedLine:null}),s=R(()=>i.matchedLine&&i.matchedLine.row||[]),o=R(()=>i.matchedLine&&i.matchedLine.col||[]),u=l=>{i.matchedLine=l};return B("identity",ye),B("updatePosition",a),B("getPositionStore",n),B("setMatchedLine",u),B("disabled",ne(e,"disabled")),B("adsorbParent",ne(e,"adsorbParent")),B("adsorbCols",e.adsorbCols||[]),B("adsorbRows",e.adsorbRows||[]),{matchedRows:s,matchedCols:o}},methods:{renderReferenceLine(){return this.referenceLineVisible?[...this.matchedCols.map(e=>k("div",{style:{width:"0",height:"100%",top:"0",left:e+"px",borderLeft:`1px dashed ${this.referenceLineColor}`,position:"absolute"}})),...this.matchedRows.map(e=>k("div",{style:{width:"100%",height:"0",left:"0",top:e+"px",borderTop:`1px dashed ${this.referenceLineColor}`,position:"absolute"}}))]:[]}},render(){return k("div",{style:{width:"100%",height:"100%",position:"relative"}},[this.$slots.default&&this.$slots.default(),...this.renderReferenceLine()])}}),ft=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:dt}),De=se(ft);(function(e){var t=oe&&oe.__createBinding||(Object.create?function(s,o,u,l){l===void 0&&(l=u),Object.defineProperty(s,l,{enumerable:!0,get:function(){return o[u]}})}:function(s,o,u,l){l===void 0&&(l=u),s[l]=o[u]});e.__esModule=!0;var a=ut,n=De;a.default.install=function(s){return s.component(a.default.name,a.default),s.component(n.default.name,n.default),s};var i=De;t(e,i,"default","DraggableContainer"),e.default=a.default})(ce);var ht=We(ce),gt={components:{Vue3DraggableResizable:ht,start:Ae},setup:()=>{var e,t,a,n,i,s,o,u,l;return i=q(),t=outerHeight*2,n=outerWidth*2,s=546,o=846,u=q((outerWidth-o)/2),l=q((outerHeight-s)/2),s=q(s),o=q(o),e=q(!0),ie(()=>{i=i.value.$el}),a=()=>{var r,d,h,b,v,M,_;h=-23,{offsetTop:M,offsetHeight:b,offsetWidth:_,offsetLeft:v}=i,d=outerHeight-h,b>d&&(b=d,s.value=d),d=outerWidth-h,_>d&&(_=d,o.value=d),M<h?l.value=h:(r=outerHeight-h-b,M>r&&(l.value=r)),v<h?u.value=h:(r=outerWidth-h-_,v>r&&(u.value=r))},{drag:i,border:a,end:()=>{a(),Se.recbar.top()},start:()=>{},deactivated:function(){xe(()=>{e.value=!0})},x:u,y:l,h:s,w:o,bw:n,bh:t,active:e}}};const ct=Ce("\u5F00\u59CB\u5F55\u5236");function vt(e,t){const a=ge("start"),n=ge("Vue3DraggableResizable");return Ne(),Oe(n,{draggable:!0,initH:e.h,initW:e.w,minH:330,minW:330,resizable:!0,style:Ee("--bh:"+e.bh+"px;--top:-"+e.bh+"px;--bw:"+e.bw+"px;--left:-"+e.bw+"px"),onActivated:t[0]||(t[0]=i=>e.print("activated")),onDeactivated:e.deactivated,onDragEnd:e.end,onDragStart:e.border,onDragging:e.border,onResizeEnd:e.end,onResizeStart:e.border,onResizing:e.border,ref:"drag",active:e.active,"onUpdate:active":t[1]||(t[1]=i=>e.active=i),h:e.h,"onUpdate:h":t[2]||(t[2]=i=>e.h=i),w:e.w,"onUpdate:w":t[3]||(t[3]=i=>e.w=i),x:e.x,"onUpdate:x":t[4]||(t[4]=i=>e.x=i),y:e.y,"onUpdate:y":t[5]||(t[5]=i=>e.y=i)},{default:he(()=>[$e("main",null,[je(a,null,{default:he(()=>[ct]),_:1})])]),_:1},8,["initH","initW","style","onDeactivated","onDragEnd","onDragStart","onDragging","onResizeEnd","onResizeStart","onResizing","active","h","w","x","y"])}var Mt=Te(gt,[["render",vt],["__scopeId","data-v-2c40ae8a"]]);export{Mt as default};
