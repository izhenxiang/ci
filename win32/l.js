var H=Object.defineProperty;var q=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var E=(e,r,o)=>r in e?H(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o,L=(e,r)=>{for(var o in r||(r={}))J.call(r,o)&&E(e,o,r[o]);if(q)for(var o of q(r))P.call(r,o)&&E(e,o,r[o]);return e};import{c as a}from"./v.js";import{i as R}from"./0.js";import{K as N,b as Q,o as u,d as v,F as S,R as D,u as B,i,t as w,p as V,m as A,z as X,O as M,S as F,s as U,I as Y,g as Z,q as O,f as ee,h as b,c as oe,w as T,e as re,j as C,l as ae}from"./k.js";import{_ as I}from"./b.js";import{m as K}from"./1.js";import{b as te}from"./q.js";import{s as se}from"./y.js";import{v as ie}from"./r.js";import"./i.js";import"./-.js";import"./$.js";import"./x.js";var y,W,$;({camera:y,main:W}=R);$=()=>{var e,r;if(gc(),document.hidden){localStorage.recing||y.x();return}switch(delete localStorage.recing,{src:e}=a,y.x(),e){case"screen":a.video="";break;default:if(!a.video){if({video:r}=localStorage,!r)return;a.video=r}e==="all"?y.circle(localStorage.\u4EBA\u50CF\u5C3A\u5BF8-0):y.rect(),setTimeout(()=>{document.hidden||W(!1)},1e3)}};document.addEventListener("visibilitychange",$);var ne={setup:()=>{var e,r,o,t,c,l;for(t=["all \u5C4F\u5E55+\u6444\u50CF\u5934\u5F55\u5236","screen \u5C4F\u5E55\u5F55\u5236","camera \u6444\u50CF\u5934\u5F55\u5236"],l=r=0,o=t.length;r<o;l=++r)e=t[l],c=e.indexOf(" "),t[l]=[e.slice(0,c),e.slice(1+c)];return N(()=>a.src,$),Q($),N(()=>a.video,_=>{var s;document.hidden||({src:s}=a,_?s==="screen"&&(a.src=localStorage.src||"all"):s!=="screen"&&(localStorage.src=a.src,a.src="screen"),$())}),{li:t,config:a,go:_=>{a.src=_}}}};const le=e=>(V("data-v-1eb91dd6"),e=e(),A(),e),de={class:"method"},ce=["onClick"],ue=le(()=>i("b",{class:"ico"},null,-1));function ve(e,r){return u(),v("div",de,[(u(!0),v(S,null,D(e.li,([o,t])=>(u(),v("a",{class:B([o,e.config.src==o?"now":""]),onClick:c=>e.go(o)},[ue,i("i",null,w(t),1)],10,ce))),256))])}var _e=I(ne,[["render",ve],["__scopeId","data-v-1eb91dd6"]]),fe={setup:()=>({config:a,disabled:X(()=>a.src==="camera"),li:"\u6574\u4E2A\u684C\u9762 \u6307\u5B9A\u533A\u57DF".split(" ")})};const pe=e=>(V("data-v-2a229f8c"),e=e(),A(),e),me={class:"bk"},he=pe(()=>i("h2",null,"\u5F55\u5236\u533A\u57DF",-1)),ge={class:"select"},be=["disabled"],ye=["value"];function $e(e,r){return u(),v("div",me,[he,i("div",ge,[M(i("select",{disabled:e.disabled,"onUpdate:modelValue":r[0]||(r[0]=o=>e.config.area=o)},[(u(!0),v(S,null,D(e.li,(o,t)=>(u(),v("option",{value:t},w(o),9,ye))),256))],8,be),[[F,e.config.area]])])])}var Se=I(fe,[["render",$e],["__scopeId","data-v-2a229f8c"]]),we={setup:()=>{var e,r,o,t,c,l,_;return l={audio:U([]),video:U([])},{mediaDevices:t}=navigator,c=async()=>{var s,n,d,f,p,m,g,h,k,z,j;m={},g=await t.enumerateDevices();for(z of g)({kind:f,label:p,deviceId:s}=z),s==="default"&&(p=p.replace("Default - ","\u9ED8\u8BA4 ")),f.endsWith("input")&&(f=f.slice(0,-5),(m[f]=m[f]||[]).push([s,p]));for(d in l)l[d].value=m[d]||[];for(d in l){if({value:k}=l[d],k.length){if(h=a[d],h){for(j of k)if([n]=j,h===n)return}h!==""&&(h=k[0][0])}else h=0;a[d]=h}},o=void 0,r=void 0,e=()=>{r&&(clearInterval(o),r(),r=void 0)},Y(e),_=Z(0),O(()=>{var s,n,d;n=["audio","video"];for(s of n)d=a[s],d&&(localStorage[s]=d)}),O(async()=>{var s,n,d,f,p,m,g;e(),{audio:d}=a,!!d&&(g=await K.audio(d),s=new AudioContext,m=s.createMediaStreamSource(g),n=s.createAnalyser(),n.minDecibels=-90,n.maxDecibels=-10,n.fftSize=32,r=()=>(m.disconnect(n),s.close()),f=n.frequencyBinCount,p=new Uint8Array(f),o=setInterval(()=>{n.getByteFrequencyData(p),_.value=Math.round(Math.min(1,Math.max(...p)/200)*100)},100),m.connect(n))}),(async()=>await c())(),L({refresh:c,config:a,x:s=>{var n;n=a[s],n?n="":n=localStorage[s]||"",a[s]=n},vol:_},l)}};const x=e=>(V("data-v-3a61f77c"),e=e(),A(),e),Ie={class:"bk"},ke=x(()=>i("h2",null,"\u8BBE\u5907\u8BBE\u7F6E",-1)),Ce={class:"video"},De={class:"select"},Ve={label:"\u8F93\u5165\u6E90"},Ae=["value"],Be=x(()=>i("optgroup",{label:"\u2500\u2500\u2500"},[i("option",{value:""},"\u7981\u7528")],-1)),Me={class:"audio"},Fe={class:"select"},Ue={label:"\u8F93\u5165\u6E90"},xe=["value"],ze=x(()=>i("optgroup",{label:"\u2500\u2500\u2500"},[i("option",{value:""},"\u7981\u7528")],-1));function je(e,r){return u(),v("div",Ie,[ke,i("li",Ce,[i("label",{class:B({e:e.config.video}),onClick:r[0]||(r[0]=o=>e.x("video")),for:"driveVideo"},null,2),i("div",De,[M(i("select",{id:"driveVideo",onFocus:r[1]||(r[1]=(...o)=>e.refresh&&e.refresh(...o)),"onUpdate:modelValue":r[2]||(r[2]=o=>e.config.video=o)},[i("optgroup",Ve,[(u(!0),v(S,null,D(e.video,([o,t])=>(u(),v("option",{value:o},w(t),9,Ae))),256))]),Be],544),[[F,e.config.video]])])]),i("li",Me,[i("label",{class:B({e:e.config.audio}),style:ee("--vol:"+e.vol+"%"),onClick:r[3]||(r[3]=o=>e.x("audio")),for:"driveAudio"},null,6),i("div",Fe,[M(i("select",{id:"driveAudio",onFocus:r[4]||(r[4]=(...o)=>e.refresh&&e.refresh(...o)),"onUpdate:modelValue":r[5]||(r[5]=o=>e.config.audio=o)},[i("optgroup",Ue,[(u(!0),v(S,null,D(e.audio,([o,t])=>(u(),v("option",{value:o},w(t),9,xe))),256))]),ze],544),[[F,e.config.audio]])])])])}var qe=I(we,[["render",je],["__scopeId","data-v-3a61f77c"]]),Ee={components:{btn:te}};const Le=e=>(V("data-v-b0e482fa"),e=e(),A(),e),Ne=Le(()=>i("b",null,null,-1));function Oe(e,r){const o=b("btn");return u(),oe(o,null,{default:T(()=>[Ne,re(e.$slots,"default",{},void 0,!0)]),_:3})}var Re=I(Ee,[["render",Oe],["__scopeId","data-v-b0e482fa"]]),G;({auto_update:G}=R);var Te={components:{src:_e,rArea:Se,drive:qe,btn:Re},setup:()=>{var e,r;return e=U("\u5F00\u59CB\u5F55\u5236"),r=o=>{e.value=`\u8BF7\u6388\u6743${o}\u540E\u70B9\u6B64\u5F55\u5236`},{txt:e,start:async()=>{var o,t,c,l,_;l=Object.entries({audio:"\u9EA6\u514B\u98CE",video:"\u6444\u50CF\u5934"});for(_ of l)if([t,o]=_,c=a[t],c)try{await K[t](c)}catch{r(o);return}if(a.src!=="camera")try{await ie()}catch{r("\u5F55\u5C4F");return}localStorage.recing=1,se()}}}};(async()=>await G.update_promise())();function Ke(e,r){const o=b("src"),t=b("r-area"),c=b("drive"),l=b("btn");return u(),v(S,null,[C(o),i("main",null,[C(t),C(c),C(l,{onClick:e.start},{default:T(()=>[ae(w(e.txt),1)]),_:1},8,["onClick"])])],64)}var to=I(Te,[["render",Ke],["__scopeId","data-v-032f415c"]]);export{to as default};
